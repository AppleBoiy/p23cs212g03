<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8"/>
    <meta
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
            name="viewport"
    />

    <!-- Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>

    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet">
    <script crossorigin="anonymous"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>

    <!-- Bootstrap Table -->
    <link
            href="https://unpkg.com/bootstrap-table@1.21.2/dist/bootstrap-table.min.css"
            rel="stylesheet"
    />
    <script src="https://unpkg.com/bootstrap-table@1.21.2/dist/bootstrap-table.min.js"></script>

    <link href="{{ url_for('static', filename='css/mytwitter.css') }}" rel="stylesheet"/>
    <link href="{{ url_for('static', filename='css/open-iconic-bootstrap.css') }}" rel="stylesheet"/>
    <link href="{{ url_for('static', filename='css/mytwitter.css') }}" rel="stylesheet"/>

    <title>My Twitter</title>
</head>

<body>
<nav class="navbar navbar-expand-md navbar-light">
    <button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
            class="navbar-toggler"
            data-target="#navbarSupportedContent" data-toggle="collapse" type="button">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">

            <li class="nav-item">
                <a class="nav-link" onclick="showHome()"><span class="oi oi-home"></span> Home</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="#"><span class="oi oi-bolt"></span> Moments</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#"><span class="oi oi-bell"></span> Notifications</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#"><span class="oi oi-envelope-open"></span> Messages</a>
            </li>
            <li class="nav-item">
                <B class="nav-link" onclick="showPost()"><span class="oi oi-signpost"></span> Blog</B>
            </li>
        </ul>
        <form class="form-inline">
            <input class="form-control" id="nav-search" placeholder="Search Twitter" type="search"/>
        </form>
    </div>
</nav>


<div class="container">
    <!-- home -->
    <div class="container mt-5 mb-5" id="home">
        <h2>Posts</h2>
        <div class="row row-cols-1 row-cols-md-2 g-4">
            {% for post in data %}
            {% if post %}
            <div class="col" post-{{ post.id }}>
                <div class="rounded shadow border-light h-100 p-3" id="">
                    <div class="card-header d-flex justify-content-between align-items-center bg-secondary text-light">
                        <h5 class="mb-0 text-white">{{ post.name }}</h5>
                        <div class="text-muted">{{ post.date_updated }}</div>
                    </div>
                    <div class="card-body overflow-auto">
                        <p class="lead text-dark">{{ post.message }}</p>
                    </div>
                    <div class="card-footer text-muted row">
                        <div class="col" name="data-updated" style="align-items: center">
                            <p>{{ post.date_updated }}</p>
                        </div>
                        <div align="right" class="col">
                            <button class="btn btn-primary" id="edit" onclick="editPost('{{ post.id }}')"
                                    type="button">Edit
                            </button>
                            <button class="btn btn-danger" id="delete" type="button">Delete</button>
                        </div>
                    </div>

                </div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>


    <div hidden="hidden" id="post">
        <div class="card rounded-lg shadow bg-light">
            <div class="card-header bg-primary text-white">
                <hA2 class="mb-0">Create New Post</hA2>
            </div>
            <div class="card-body">
                <form id="add-post-form">
                    <div class="mb-3">
                        <label class="form-label" for="name">Name:</label>
                        <input
                                class="form-control"
                                id="name"
                                name="name"
                                placeholder="Enter your name"
                                required
                                type="text"
                        />
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="message">Message:</label>
                        <textarea
                                class="form-control"
                                id="message"
                                name="message"
                                placeholder="Write your message here"
                                required
                                rows="5"
                        ></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="email">Email:</label>
                        <input
                                class="form-control"
                                id="email"
                                name="email"
                                placeholder="Enter your email address"
                                required
                                type="email"
                        />
                    </div>
                    <button class="btn btn-primary" type="submit">
                        <span class="oi oi-check mr-1"></span>
                        Submit Post
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div hidden="hidden" id="edit-post">
        <div class="card rounded-lg shadow bg-light">
            <div class="card-header bg-primary text-white">
                <h2 class="mb-0" id="edit-name"></h2>

            </div>
            <div class="card-body">
                <form id="edit-post-form">
                    <div class="mb-3">
                        <label class="form-label
                        " for="message">Message:</label>
                        <textarea
                                class="form-control"
                                id="edit-message"
                                name="message"
                                placeholder="Write your message here"
                                required
                                rows="5"
                        ></textarea>
                    </div>
                    <button class="btn btn-primary" id="submit-edit-post">
                        <span class="oi oi-check mr-1"></span>
                        Submit Post
                    </button>
                </form>
            </div>
        </div>
    </div>


</div>


<!-- Optional JavaScript -->
<script>

    //add on hover to nav items show mouse pointer
    $(".nav-item").hover(function () {
        $(this).addClass("bg-light");
        $(this).css("cursor", "pointer");
    }, function () {
        $(this).removeClass("bg-light");
    });

    function editPost(id) {
        showEditPost();
    }

    function showHome() {

        //reload the page every time the home button is clicked
        location.reload();

        $("#home").removeAttr("hidden");
        $("#post").attr("hidden", "hidden");
        $("#edit-post").attr("hidden", "hidden");

    }

    function showPost() {
        $("#home").attr("hidden", "hidden");
        $("#edit-post").attr("hidden", "hidden");
        $("#post").removeAttr("hidden");
    }

    function showEditPost() {
        $("#home").attr("hidden", "hidden");
        $("#post").attr("hidden", "hidden");
        $("#edit-post").removeAttr("hidden");
    }


    function clearForm() {
        $("#add-post-form").trigger("reset");
    }


    $("#add-post-form").submit(function (event) {
        event.preventDefault();

        console.log("Submit Post");

        var name = $("#name").val();
        var message = $("#message").val();
        var email = $("#email").val();
        var form = {
            name: name,
            message: message,
            email: email,
        }

        $.post("/hw10", form, function (e) {
            clearForm();
        });

        // show home and then refresh
        showHome();

    });


    $("#edit-post").submit(function (event) {
        event.preventDefault();
        var id = $("#edit-id").val();
        var message = $("#edit-message").val();
        var form = {
            id: id,
            message: message,
        }

        $.post("hw10/edit", form, function (e) {
            clearForm();
        });

        // show home and then refresh
        showHome();

    });


    $(document).on("click", "#delete", function () {
        alert("Delete");
    });


</script>
</body>
</html>
